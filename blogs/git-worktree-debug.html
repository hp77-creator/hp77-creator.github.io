<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" sizes="any" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    
    <!-- Primary Meta Tags -->
    <title>hp77</title>
    <meta name="title" content="hp77" />
    <meta name="description" content="Software Engineer | Open Source Enthusiast" />
    
    <!-- Default Open Graph / Facebook (will be overridden by individual pages) -->
    <meta property="og:type" content="website" />
    
    <!-- Default Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    
    <!-- Additional Meta Tags -->
    <meta name="robots" content="index, follow" />
    <meta name="author" content="Himanshu Pandey (hp77)" />
    <link rel="canonical" href="https://hp77-creator.github.io" />
    
    
		<link href="../app/immutable/assets/0.74e45d02.css" rel="stylesheet">
		<link href="../app/immutable/assets/4.3f268169.css" rel="stylesheet">
		<link rel="modulepreload" href="../app/immutable/entry/start.afda86c0.js">
		<link rel="modulepreload" href="../app/immutable/chunks/index.cf6e02a0.js">
		<link rel="modulepreload" href="../app/immutable/chunks/singletons.25524a8e.js">
		<link rel="modulepreload" href="../app/immutable/entry/app.72c5bdd9.js">
		<link rel="modulepreload" href="../app/immutable/nodes/0.d2f1f9f0.js">
		<link rel="modulepreload" href="../app/immutable/chunks/stores.c1d9b567.js">
		<link rel="modulepreload" href="../app/immutable/nodes/4.616ed0a9.js"><title>TIL - Git worktree &amp; WCGW even after Server processes request sucessfully | hp77&#39;s Blog</title><!-- HEAD_svelte-i9bwvf_START --><meta name="description" content="Software Engineer | Open Source Enthusiast"><meta property="og:title" content="hp77"><meta property="og:description" content="Software Engineer | Open Source Enthusiast"><meta name="twitter:title" content="hp77"><meta name="twitter:description" content="Software Engineer | Open Source Enthusiast"><!-- HEAD_svelte-i9bwvf_END --><!-- HEAD_svelte-15f8k0l_START -->
    <meta name="description" content="Learning more on internals of Git &amp; Web Server">
    
    
    <meta property="og:type" content="article">
    <meta property="og:title" content="TIL - Git worktree &amp; WCGW even after Server processes request sucessfully | hp77's Blog">
    <meta property="og:description" content="Learning more on internals of Git &amp; Web Server">
    <meta property="og:url" content="http://sveltekit-prerender/blogs/git-worktree-debug">
    <meta property="og:site_name" content="hp77's Blog">
    <meta property="article:published_time" content="2025-03-28">
    <meta property="article:author" content="Himanshu Pandey">
    <meta property="article:tag" content="git"><meta property="article:tag" content="java"><meta property="article:tag" content="spring-boot">
    
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@theboycalledhp">
    <meta name="twitter:creator" content="@theboycalledhp">
    <meta name="twitter:title" content="TIL - Git worktree &amp; WCGW even after Server processes request sucessfully | hp77's Blog">
    <meta name="twitter:description" content="Learning more on internals of Git &amp; Web Server">
    
    
    <link rel="canonical" href="http://sveltekit-prerender/blogs/git-worktree-debug">
    
    <script type="application/ld+json">{JSON.stringify(structuredData)}
      </script><!-- HEAD_svelte-15f8k0l_END -->
  </head>
  <body>
    <div>





<header class="layout-md flex justify-between items-start header-container svelte-5mrz57" data-sveltekit-noscroll data-sveltekit-preload-code="eager"><h1 class="font-bold text-black text-2xl mb-6 name-container"><a href="/" class="name-link svelte-5mrz57"><span class="name-text svelte-5mrz57">Himanshu</span>
      <span class="name-text svelte-5mrz57">Pandey</span></a>
    </h1>
  <nav class="nav-links svelte-5mrz57"><a href="/blogs" class="nav-link svelte-5mrz57">blogs
      </a><a href="/projects" class="nav-link svelte-5mrz57">projects
      </a><a href="/resume" class="nav-link svelte-5mrz57">resume
      </a></nav>
</header>

<main>

<article class="layout-md py-8" itemscope itemtype="https://schema.org/BlogPosting"><header class="mb-8"><h1 class="text-3xl font-bold mb-4" itemprop="headline">TIL - Git worktree &amp; WCGW even after Server processes request sucessfully</h1>
      <time datetime="2025-03-28" itemprop="datePublished" class="text-neutral-500">March 28, 2025</time>
      <p class="text-neutral-600 mt-2" itemprop="description">Learning more on internals of Git &amp; Web Server</p></header>

    <div class="prose prose-neutral max-w-none prose-headings:font-semibold prose-a:text-blue-600" itemprop="articleBody"><div class="md-output svelte-19wf98v"><!-- HTML_TAG_START --><p>I am currently working on an internal tool where I am tasked with creating a microservice to interact with a client. Tech stack that we use in my organization
is mostly in Java(Spring-boot). Spring-boot is such a powerful and beautiful framework. You can create servers so easily. It’s IOC(Inversion of
control) paradigm, it’s autoconfiguration and dependency management all lead to a wonderful developer experience.</p>
<p>I mapped an endpoint in my controller like following:</p>
<pre><code class="language-java">
@PostMapping(&quot;/post/text&quot;)
public ResponseEntity&lt;Text&gt; addText(@Valid @RequestBody RequestBody request) {
    return Response.ok(dependentService.addText(request));
}
</code></pre>
<p>It was a pretty simple endpoint, and in the service implementation, I was simply saving whatever the user was sending from their end, ofc with validations.
I ran the server, It compiled and then executed without any error, Server was up. I hit my create request using an http client, 
I observed a strange thing, I see that server is returning me a <code>500</code> with some <code>Internal Server Exception</code>, I thought let’s check the server logs, there might
be something that I missed.
To my shock, there was nothing in server logs, nada. It baffled me even more, I was like what went wrong here. I put some debugger points and checked with that, inside service, function is returning expected response, inside controller, If I execute the return statement separately, using <code>Evaluate expression</code> of IntelliJ, I see correct response, so I continue the execution and again same error.</p>
<p>Well, At this point, I was questioning my configuration, did I mess up anything there, I don’t know, I looked around, took reference from other services, I was 
following what should be followed but I was getting error meanwhile other services were working fine and worst part, I didn’t know from where the error was coming. I approached with this problem to my colleague, they mentioned they have seen this same issue before, they suggested to add a configuration for <code>ObjectMapper</code>, of course, the error must be happening in the serialization layer, logs for that are not shown by default. To see that, I added following lines in the 
<code>application.properties</code></p>
<pre><code>logging.level.org.springframework.web=debug
logging.level.com.fasterxml.jackson.databind=debug
</code></pre>
<p>And indeed, Error was occuring because of a model mismatch. I fixed that model and then the issue was resolved. This incident made me realize how much we take 
for granted different abstractions that frameworks provide, It prompted me to always think in terms of first principle whenever we get stuck and look beyond 
abstractions provided by your framework.</p>
<hr>
<p>Git Worktree</p>
<p>Have you ever had a project, where you were working on a branch, you have some changes which are not committed but then you receive a requirement which needs a new branch from your <code>main</code>. What would you do in this case?</p>
<p>Before today, I would have done <code>git stash</code>, switch <code>HEAD</code> to <code>main</code> and then create another branch from there and work on the higher priority feature/fix. 
But Today I learned that there exists something like <code>git worktree</code> and it is such a wonderful command. Essentially it creates a new repo for you from your existing git objects from the branch that you mention, example:</p>
<pre><code class="language-shell">git worktree add -b emergency-fix ../temp master
</code></pre>
<p>Above command will create a new repo in your parent directory with name <code>temp</code> and switch to <code>emergency-fix</code> branch and you can simply <code>cd</code> or (<code>pushd</code>) into it and start working on your fix, when 
done you can simply commit from the new directory and then switch back to your old directory.</p>
<p>This command legit helps you have multiple context for your project, It extends the concept of branch, I was reading more about it in <code>Mastering Git</code> and during
my read, I learnt that it has been there for long time and It was shock for me that during my entire college years and now dev years, I didn’t see it being 
mentioned much. 
I am modifying my git workflow to include this command and have better separation for concern for different features. Features like this make you realize how much you don’t know about some of the tools that you think you might be knowing a lot. Answer is to always <code>Stay curious</code>.</p>
<p>Workflow that I am switching to, if there’s any feature that I need to work on, what I do is</p>
<pre><code class="language-shell">git worktree add -b account_api_fix ../api-fix main 
</code></pre>
<p><code>-b</code> creates a new branch, <code>../api-fix</code> creates a new worktree in the parent directory of current location, <code>main</code> is for from where it 
should branch the new branch and create the worktree.</p>
<p>After work is done, I simply do</p>
<pre><code class="language-shell">git worktree remove &lt;worktree-name&gt;
</code></pre>
<p>above command removes the worktree from the <code>git</code> object and also removes the extra created directory.</p>
<p>Also, Would like to mention that when you change your directory, you might have to reinstall your dependencies which you normally ignore, example <code>venv</code> dir in <code>python</code> and <code>node_modules</code> in <code>Javascript</code></p>
<hr>
<h2 id="references">References</h2>
<ul>
<li><a rel="external" href="https://www.amazon.in/Mastering-Git-Jakub-Narebski/dp/1783553758" class="link">Mastering Git</a></li>
<li><a rel="external" href="https://git-scm.com/docs/git-worktree" class="link">Git Worktree documentation</a></li>
</ul>
<!-- HTML_TAG_END -->
</div></div>

    <div class="mt-8 pt-8 border-t border-neutral-200"><h2 class="text-xl font-semibold mb-4">Comments &amp; Reactions</h2>
  
  <div class="mb-6 p-4 bg-blue-50 rounded-lg text-sm text-blue-800"><p>💡 Comments are powered by GitHub Discussions. When you sign in to comment, no personal data is collected or stored by this website. All interactions are handled directly through GitHub&#39;s secure authentication system.</p></div>

  <div id="giscus-container"></div></div>

    <footer class="mt-12 pt-8 border-t border-neutral-200"><a href="/blogs" class="text-blue-600 hover:underline">← Back to all posts</a></footer></article></main>

<footer class="layout-md mt-20 text-lg flex flex-col space-y-4 footer-container svelte-1xjvbnz"><div class="row svelte-1xjvbnz" style="animation-delay: 0ms"><span class="label svelte-1xjvbnz">Twitter</span>
      <hr class="svelte-1xjvbnz">
      <a class="link social-link svelte-1xjvbnz" href="https://twitter.com/theboycalledhp" target="_blank" rel="noopener noreferrer">@theboycalledhp</a>
    </div><div class="row svelte-1xjvbnz" style="animation-delay: 100ms"><span class="label svelte-1xjvbnz">GitHub</span>
      <hr class="svelte-1xjvbnz">
      <a class="link social-link svelte-1xjvbnz" href="https://github.com/hp77-creator" target="_blank" rel="noopener noreferrer">@hp77-creator</a>
    </div><div class="row svelte-1xjvbnz" style="animation-delay: 200ms"><span class="label svelte-1xjvbnz">Email</span>
      <hr class="svelte-1xjvbnz">
      <a class="link social-link svelte-1xjvbnz" href="mailto:himanshu.dn.pandey@gmail.com">himanshu.dn.pandey@gmail.com</a>
    </div>
</footer>


			
			<script>
				{
					__sveltekit_xw69yq = {
						base: new URL("..", location).pathname.slice(0, -1),
						env: {}
					};

					const element = document.currentScript.parentElement;

					const data = [null,{"type":"data","data":{post:{slug:"git-worktree-debug",title:"TIL - Git worktree & WCGW even after Server processes request sucessfully",date:"2025-03-28",description:"Learning more on internals of Git & Web Server",content:"\nI am currently working on an internal tool where I am tasked with creating a microservice to interact with a client. Tech stack that we use in my organization\nis mostly in Java(Spring-boot). Spring-boot is such a powerful and beautiful framework. You can create servers so easily. It's IOC(Inversion of\ncontrol) paradigm, it's autoconfiguration and dependency management all lead to a wonderful developer experience.\n\nI mapped an endpoint in my controller like following:\n```java\n\n@PostMapping(\"/post/text\")\npublic ResponseEntity\u003CText> addText(@Valid @RequestBody RequestBody request) {\n    return Response.ok(dependentService.addText(request));\n}\n```\nIt was a pretty simple endpoint, and in the service implementation, I was simply saving whatever the user was sending from their end, ofc with validations.\nI ran the server, It compiled and then executed without any error, Server was up. I hit my create request using an http client, \nI observed a strange thing, I see that server is returning me a `500` with some `Internal Server Exception`, I thought let's check the server logs, there might\nbe something that I missed.\nTo my shock, there was nothing in server logs, nada. It baffled me even more, I was like what went wrong here. I put some debugger points and checked with that, inside service, function is returning expected response, inside controller, If I execute the return statement separately, using `Evaluate expression` of IntelliJ, I see correct response, so I continue the execution and again same error.\n\nWell, At this point, I was questioning my configuration, did I mess up anything there, I don't know, I looked around, took reference from other services, I was \nfollowing what should be followed but I was getting error meanwhile other services were working fine and worst part, I didn't know from where the error was coming. I approached with this problem to my colleague, they mentioned they have seen this same issue before, they suggested to add a configuration for `ObjectMapper`, of course, the error must be happening in the serialization layer, logs for that are not shown by default. To see that, I added following lines in the \n`application.properties`\n```\nlogging.level.org.springframework.web=debug\nlogging.level.com.fasterxml.jackson.databind=debug\n```\nAnd indeed, Error was occuring because of a model mismatch. I fixed that model and then the issue was resolved. This incident made me realize how much we take \nfor granted different abstractions that frameworks provide, It prompted me to always think in terms of first principle whenever we get stuck and look beyond \nabstractions provided by your framework.\n\n---\n\nGit Worktree\n\nHave you ever had a project, where you were working on a branch, you have some changes which are not committed but then you receive a requirement which needs a new branch from your `main`. What would you do in this case?\n\nBefore today, I would have done `git stash`, switch `HEAD` to `main` and then create another branch from there and work on the higher priority feature/fix. \nBut Today I learned that there exists something like `git worktree` and it is such a wonderful command. Essentially it creates a new repo for you from your existing git objects from the branch that you mention, example:\n```shell\ngit worktree add -b emergency-fix ../temp master\n```\nAbove command will create a new repo in your parent directory with name `temp` and switch to `emergency-fix` branch and you can simply `cd` or (`pushd`) into it and start working on your fix, when \ndone you can simply commit from the new directory and then switch back to your old directory.\n\nThis command legit helps you have multiple context for your project, It extends the concept of branch, I was reading more about it in `Mastering Git` and during\nmy read, I learnt that it has been there for long time and It was shock for me that during my entire college years and now dev years, I didn't see it being \nmentioned much. \nI am modifying my git workflow to include this command and have better separation for concern for different features. Features like this make you realize how much you don't know about some of the tools that you think you might be knowing a lot. Answer is to always `Stay curious`.\n\nWorkflow that I am switching to, if there's any feature that I need to work on, what I do is\n```shell\ngit worktree add -b account_api_fix ../api-fix main \n```\n`-b` creates a new branch, `../api-fix` creates a new worktree in the parent directory of current location, `main` is for from where it \nshould branch the new branch and create the worktree.\n\nAfter work is done, I simply do\n```shell\ngit worktree remove \u003Cworktree-name>\n```\nabove command removes the worktree from the `git` object and also removes the extra created directory.\n\n\nAlso, Would like to mention that when you change your directory, you might have to reinstall your dependencies which you normally ignore, example `venv` dir in `python` and `node_modules` in `Javascript`\n\n---- \n\n## References\n\n- [Mastering Git](https://www.amazon.in/Mastering-Git-Jakub-Narebski/dp/1783553758)\n- [Git Worktree documentation](https://git-scm.com/docs/git-worktree)\n",visible:true,tags:["git","java","spring-boot"]}},"uses":{"params":["slug"]}}];

					Promise.all([
						import("../app/immutable/entry/start.afda86c0.js"),
						import("../app/immutable/entry/app.72c5bdd9.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 4],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
  </body>
</html>
